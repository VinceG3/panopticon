STDOUT.sync

ProjectName = 'proximeter'
DevDirectory = File.join('/', 'home', 'vince', 'src', ProjectName)
ProdDirectory = File.join('/', 'home', 'deploy', ProjectName, "current")
Directory = ProdDirectory
start_command = "cd #{Directory} && bundle exec " << File.join("bin", ProjectName)
StartCommand = start_command
StopCommand = "#{StartCommand} -k"
PidFile = File.join(Directory, "log", "#{ProjectName}.pid")
LogFile = File.join(Directory, "log", "#{ProjectName}.log")

God.watch do |w|
  w.name = ProjectName
  w.start = StartCommand
  w.stop = StopCommand
  w.restart = StartCommand
  w.pid_file = PidFile
  w.log = LogFile
  w.dir = Directory

  w.interval        = 30.seconds
  w.start_grace     = 15.seconds
  w.restart_grace   = 15.seconds
  w.behavior(:clean_pid_file)

  w.start_if do |start|
    start.condition(:process_running) do |c|
      c.interval = 5.seconds
      c.running = false
    end
  end
end